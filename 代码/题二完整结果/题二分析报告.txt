 光伏电站日前发电功率预测分析报告

 1. 预测任务概述
本项目旨在构建一个基于历史数据的光伏电站日前发电功率预测模型。该模型的目标是提前一天预测光伏电站的发电功率，预测时间分辨率为15分钟。准确的功率预测对于电网的稳定运行、调度计划以及能源交易具有重要意义。

 2. 数据集与划分
 数据来源：使用 `station01.csv` 数据集，包含了光伏电站的历史运行数据，主要包括时间戳和实际发电功率。
 时间范围：数据覆盖从 2018年6月30日 至 2019年6月13日。
 训练集与测试集划分：
     测试集：选取每年2月、5月、8月、11月的最后一周数据作为测试集，用于评估模型的日前预测能力。
     训练集：除测试集之外的其余数据用作训练集。

 3. 模型构建流程
 3.1 数据预处理
1.  数据加载与清洗：加载CSV数据，将时间列解析为datetime对象，并设置为索引。
2.  中值滤波：对原始功率数据（`power`列）应用窗口大小为5的中值滤波器，得到 `power_filtered`，以平滑噪声和去除异常尖峰。
3.  Zscore 标准化：对滤波后的功率数据 `power_filtered` 进行Zscore标准化，得到 `power_processed`，使其均值为0，标准差为1，便于模型训练。

 3.2 特征工程
为了捕捉时间序列的复杂模式和依赖关系，构建了以下类型的特征：
1.  基础时间特征：小时 (`hour`)、星期几 (`dayofweek`)、一年中的第几天 (`dayofyear`)、月份 (`month`)、季度 (`quarter`)、季节编号 (`season_num`)。
2.  周期性编码特征：对 `hour` 和 `dayofyear` 进行正弦和余弦变换 (`hour_sin`, `hour_cos`, `dayofyear_sin`, `dayofyear_cos`)，以更好地表示其周期性。
3.  滞后特征 (Lag Features)：
    *   日级别：前1天、2天、7天的标准化功率值 (`power_lag_1d`, `power_lag_2d`, `power_lag_7d`)。
    *   小时级别：前60分钟、120分钟、180分钟、240分钟（即前1、2、3、4小时）的标准化功率值 (`power_lag_60min`, `power_lag_120min`, `power_lag_180min`, `power_lag_240min`)。
4.  滚动统计特征：基于前一天（滞后96个数据点）的功率数据，计算过去24小时（96个数据点）的滚动均值 (`rolling_mean_24h_lag1d`) 和滚动标准差 (`rolling_std_24h_lag1d`)。

 3.3 预测模型
 模型选择：采用 XGBoost (Extreme Gradient Boosting) 回归模型进行功率预测。XGBoost是一种高效且广泛使用的梯度提升算法，以其高性能和灵活性著称。
 超参数优化：使用 `GridSearchCV` 进行超参数搜索，以找到最优的模型参数组合。搜索的参数网格包括 `learning_rate`, `max_depth`, `subsample`, `colsample_bytree`, 和 `gamma`。`n_estimators` 固定为较高值1000，并通过 `early_stopping_rounds=30` 防止过拟合。交叉验证折数为3，评估指标为 `neg_root_mean_squared_error`。

 4. 预测结果分析
 4.1 总体性能指标 (白昼时段)
根据 `预测误差分析报告.txt`，模型在测试集白昼时段（实际功率 > 0 MW）的性能指标如下：
 归一化均方根误差 (E_rmse_norm): 0.1366
 归一化平均绝对误差 (E_mae_norm): 0.1023
 归一化平均误差 (E_me_norm): 0.0118
 相关系数 (r): 0.8660
 准确率 (C_R %): 86.3440%
 合格率 (Q_R %): 92.3194%
 白昼样本数: 1315

这些指标表明模型具有较好的预测性能。相关系数0.8660表示预测值与实际值之间有较强的线性关系。准确率达到86.34%，合格率（预测误差在额定容量的25%以内）达到92.32%，说明模型在大部分情况下预测较为准确。

 4.2 可视化分析
 时间序列预测对比图 (`时间序列预测对比图.png`)：该图展示了模型在一个典型测试月份（如2月）的实际功率与预测功率的时间序列曲线。通过观察，可以评估模型对功率日变化模式、峰值和谷值的捕捉能力。总体上，预测曲线能够较好地跟随实际功率的变化趋势。
 预测效果散点图 (`预测效果散点图.png`)：此图将白昼时段的实际功率与预测功率进行散点比较。点分布越接近对角线 (y=x)，表明预测效果越好。当前散点图显示大部分数据点集中在对角线附近，进一步证实了模型的预测能力。
 误差分析图 (`误差分析图.png`)：该图展示了白昼时段预测误差（实际功率  预测功率）的分布情况。误差分布接近正态分布，且中心在0附近，表明模型的预测偏差较小，没有明显的系统性高估或低估。
 特征重要性分析图 (`特征重要性分析图.png`)：此图基于增益（Gain）显示了模型训练过程中各特征的重要性排序。通过此图可以识别对光伏功率预测影响最大的因素，例如滞后功率值、时间特征（如小时的正余弦编码）等，为后续模型优化和特征选择提供依据。

 4.3 月度预测结果
模型针对2月、5月、8月、11月分别生成了预测结果，并保存为CSV文件 (`2月预测结果.csv`, `5月预测结果.csv`, `8月预测结果.csv`, `11月预测结果.csv`)。汇总的预测结果见 `所有预测结果.csv`。这些文件详细记录了每个预测时间点的实际功率和预测功率，可供进一步的细致分析。

 5. 结论与建议
 5.1 结论
 本项目成功构建了一个基于XGBoost的日前光伏功率预测模型。
 通过细致的数据预处理、特征工程和超参数优化，模型在选定的测试集上表现出良好的预测性能，白昼准确率达到86.34%，合格率达到92.32%。
 模型能够较好地捕捉光伏功率的日变化特性和趋势。
 特征重要性分析揭示了影响预测的关键因素。

 5.2 建议
1.  进一步优化特征工程：
    *   考虑引入更多外部气象数据特征，如辐照度、温度、湿度、云量等（如果可用），这些通常是影响光伏发电的关键物理因素。
    *   探索更复杂的滞后组合或非线性特征变换。
2.  模型调优与集成：
    *   尝试更细致的超参数调整范围或使用更高级的优化算法（如贝叶斯优化）。
    *   考虑模型集成方法（如Stacking、Blending），结合不同类型模型的优势可能进一步提升预测精度。
3.  长期性能监控：在实际应用中，应持续监控模型性能，并根据数据分布的变化（概念漂移）定期重新训练或调整模型。
4.  不确定性量化：除了点预测，可以研究预测区间或概率预测，为决策提供更全面的信息。

 6. 附件说明 (位于 `题二完整结果` 文件夹)
 `预测误差分析报告.txt`：包含模型在白昼时段的关键性能评估指标。
 `预测效果散点图.png`：实际功率与预测功率的散点对比图 (白昼时段)。
 `误差分析图.png`：预测误差的分布直方图 (白昼时段)。
 `特征重要性分析图.png`：XGBoost模型训练得到的特征重要性排序图。
 `时间序列预测对比图.png`：选取某测试月份的实际功率与预测功率的时间序列对比。
 `所有预测结果.csv`：汇总了所有测试月份（2, 5, 8, 11月最后一周）的预测结果，包含起报时间、预报时间、实际功率、预测功率。
 `2月预测结果.csv`：2月份测试周期的详细预测结果。
 `5月预测结果.csv`：5月份测试周期的详细预测结果。
 `8月预测结果.csv`：8月份测试周期的详细预测结果。
 `11月预测结果.csv`：11月份测试周期的详细预测结果。
